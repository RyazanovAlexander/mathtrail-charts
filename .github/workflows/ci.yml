name: CI

on:
  pull_request:
    branches: [main]

jobs:
  verify-charts:
    runs-on: mathtrail-runners
    steps:
      - name: Checkout
        uses: actions/checkout@v4

      - name: Run just update
        run: just update

      - name: Ensure charts are up to date
        shell: bash
        run: |
          set -e
          if [ -n "$(git status --porcelain charts/charts)" ]; then
            echo "âŒ charts/charts changed after running 'just update'."
            echo "   Run 'just update' locally and commit the changes."
            git status --porcelain charts/charts
            exit 1
          fi
